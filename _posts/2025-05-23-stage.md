Mijn Stageproject: SIEM met Wazuh

Inleiding

Tijdens mijn stage bij Stad Mechelen kreeg ik de kans om hands-on te werken met Wazuh, een open-source SIEM-oplossing. Mijn doel was om een veilige, schaalbare en inzichtelijke monitoringomgeving op te zetten die logdata van verschillende endpoints verzamelt, analyseert en visualiseert.

Opzet van de Infrastructuur

🖥️ Hardware & VM’s

De Wazuh omgeving bestond uit drie hoofdcomponenten, elk draaiend op een eigen VM:

Wazuh Manager: 16 vCPU, 16 GB RAM

Wazuh Indexer: 16 vCPU, 16 GB RAM

Wazuh Dashboard: 8 vCPU, 8 GB RAM

Verder waren er extra VM's als agent (Linux & Windows) om logdata te verzamelen.

Installatie Stappen

🔧 Indexer

curl -sO https://packages.wazuh.com/4.10/wazuh-install.sh
bash wazuh-install.sh --wazuh-indexer node-1

⚙️ Manager

bash wazuh-install.sh --wazuh-server wazuh-1

📊 Dashboard

bash wazuh-install.sh --wazuh-dashboard dashboard

Functionaliteiten

📦 Logging & Monitoring

OS-logs (Linux, Windows, macOS)

Webserver logs (Apache)

SSL-certificaatvervaldata

Audit logs, journald, syslog

🔒 Beveiliging

File Integrity Monitoring (FIM)

Security Configuration Assessment (SCA)

Vulnerability Detection

Active Response (bijv. blokkeren van brute-force aanvallen)

📈 Dashboards

Kibana-visualisaties tonen:

Realtime dreigingen

Activiteit per agent

Alerts per categorie

Vergelijking: Wazuh vs Andere SIEM-oplossingen

Oplossing

Open-source

Prijs

AI/ML

Gebruiksgemak

Wazuh

✅

Gratis

❌

😓 Moeilijk

Splunk

❌

~€980/mnd

❌

😐 Gemiddeld

Microsoft Sentinel

❌

~€1000/mnd

✅

😊 Zeer makkelijk

Problemen & Oplossingen

API faalt door queue-fout: Herinstallatie van de Wazuh-manager was nodig.

Dashboard werkt niet na herstart: Oorzaak was DHCP-lease → opgelost door statische IP’s te gebruiken.

Azure-integratie brak na IP-wijziging: Herconfiguratie noodzakelijk.

Beveiligingstips

Gebruik TLS tussen alle componenten

Installeer NGINX als reverse proxy voor SSL

Segmentatie van netwerk & firewallregels (alleen noodzakelijke poorten open)

Conclusie

Wazuh biedt een krachtige SIEM-oplossing, mits je bereid bent om deze grondig te configureren en beheren. De ervaring gaf me inzicht in loganalyse, netwerkbeveiliging en automatisatie van threat detection.

Links

Wazuh Docs

YouTube Tutorial
